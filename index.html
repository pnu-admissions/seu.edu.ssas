<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ - Ø§Ù„Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ù…ÙØªÙˆØ­Ø©</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root{
--main-blue:#0056b3;
--gold:#d4af37;
--bg:#ffffff;
}
*{box-sizing:border-box;margin:0;padding:0;font-family:'Cairo',sans-serif;}
body{background:var(--bg);color:#222;}
input, select, textarea, button{font-family:'Cairo',sans-serif;}
.container{max-width:900px;margin:40px auto;background:#fff;border-radius:14px;padding:30px;box-shadow:0 10px 20px rgba(0,0,0,0.12);}
h1{text-align:center;color:var(--main-blue);margin-bottom:20px;}
label{display:block;margin-bottom:5px;font-weight:600;color:var(--main-blue);}
input,select,textarea{width:100%;padding:10px;border:1px solid #ccc;border-radius:8px;margin-bottom:12px;}
textarea{resize:vertical;}
button{padding:12px 25px;border:none;border-radius:10px;font-weight:700;cursor:pointer;}
button.submit{background:var(--main-blue);color:#fff;}
button.cancel{background:#9e9e9e;color:#fff;margin-left:10px;}
.success-message{display:none;text-align:center;padding:30px;background:#e0f5e9;border-radius:14px;color:var(--main-blue);font-weight:700;margin-top:20px;}
.toast{position:fixed;top:20px;right:20px;background:var(--main-blue);color:#fff;padding:12px 18px;border-radius:8px;opacity:0;transform:translateY(-10px);transition:all .4s ease;z-index:999;}
.toast.show{opacity:1;transform:translateY(0);}
.payment-section{display:none;margin-top:20px;}
.payment-section h2{color:var(--main-blue);}
.payment-info{background:#f5f5f5;padding:15px;border-radius:10px;margin-bottom:15px;}
.payment-info p{margin:5px 0;}
</style>
</head>
<body>

<div class="container" id="formContainer">
<h1>Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ - Ø§Ù„Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ù…ÙØªÙˆØ­Ø©</h1>

<form id="registrationForm">
<label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ *</label><input type="text" name="fullName" required>
<label>Ø§Ù„Ø¬Ù†Ø³ *</label><select name="gender" required><option value="">Ø§Ø®ØªØ±...</option><option>Ø°ÙƒØ±</option><option>Ø£Ù†Ø«Ù‰</option></select>
<label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ *</label><input type="email" name="email" required>
<label>Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ *</label><input type="tel" name="phone" required>
<label>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© *</label><input type="text" name="city" required>

<hr>
<h3>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¯Ø±Ø§Ø³Ø©</h3>
<label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø¤Ù‡Ù„ Ø§Ù„Ø³Ø§Ø¨Ù‚ *</label><select name="prevDegree" required><option value="">Ø§Ø®ØªØ±...</option><option>Ø«Ø§Ù†ÙˆÙŠ</option><option>Ø¯Ø¨Ù„ÙˆÙ…</option><option>Ø¨ÙƒØ§Ù„ÙˆØ±ÙŠÙˆØ³</option><option>Ù…Ø§Ø¬Ø³ØªÙŠØ±</option></select>
<label>Ù†ÙˆØ¹ Ø§Ù„Ø¯Ø±Ø§Ø³Ø© *</label><select name="studyType" required><option value="">Ø§Ø®ØªØ±...</option><option>Ø§Ù†ØªØ¸Ø§Ù…</option><option>Ø§Ù†ØªØ³Ø§Ø¨</option><option>ØªØ¹Ù„ÙŠÙ… Ø¹Ù† Ø¨Ø¹Ø¯</option></select>
<label>Ø§Ù„ÙƒÙ„ÙŠØ© / Ø§Ù„ØªØ®ØµØµ *</label><input type="text" name="facultyMajor" required>

<hr>
<h3>Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª</h3>
<label>Ø±ÙØ¹ Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ù…Ø¤Ù‡Ù„ *</label><input type="file" name="certificateFile" accept=".pdf,.jpg,.png" required>
<label>Ø±ÙØ¹ Ø§Ù„Ù‡ÙˆÙŠØ© *</label><input type="file" name="idFile" accept=".pdf,.jpg,.png" required>

<div style="margin-top:20px;">
<button type="submit" class="submit">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
<button type="reset" class="cancel">Ø¥Ù„ØºØ§Ø¡</button>
</div>
</form>

<div class="payment-section" id="paymentSection">
<h2>ØµÙØ­Ø© Ø§Ù„Ø³Ø¯Ø§Ø¯</h2>
<div class="payment-info">
<p>ğŸ“Œ Ø§Ù„Ù…Ø¨Ù„Øº: <strong>444 Ø±ÙŠØ§Ù„</strong></p>
<p>ğŸ¦ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ: <strong>SA8280000859608014826386</strong></p>
</div>
<label>Ø§Ø³Ù… Ø§Ù„Ù…Ø­ÙˆÙ„ *</label><input type="text" id="payerName" required>
<label>Ø±Ù‚Ù… Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø­ÙˆÙ„ *</label><input type="text" id="payerAccount" required>
<label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ù…Ù„ÙŠØ© *</label><input type="date" id="paymentDate" required>
<label>Ø±ÙØ¹ Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø¯ÙØ¹ *</label><input type="file" id="receiptFile" accept=".pdf,.jpg,.png" required>
<button id="submitPayment" class="submit" style="margin-top:15px;">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø³Ø¯Ø§Ø¯</button>
</div>

<div class="success-message" id="successMessage">
ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§ØªÙƒØŒ Ø³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ø£Ùˆ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠ.
</div>

<div class="toast" id="toast"></div>

<script>
// Toast
function showToast(msg){
const toast=document.getElementById('toast');
toast.textContent=msg;
toast.classList.add('show');
setTimeout(()=>toast.classList.remove('show'),2500);
}

// ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª Ø¥Ù„Ù‰ base64
async function fileToBase64(file){
  return new Promise((resolve,reject)=>{
    const reader = new FileReader();
    reader.onload = ()=>resolve(reader.result.split(',')[1]);
    reader.onerror = error => reject(error);
    reader.readAsDataURL(file);
  });
}

// Ø¥Ø±Ø³Ø§Ù„ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
document.getElementById('registrationForm').addEventListener('submit',function(e){
e.preventDefault();
const form = e.target;

async function sendData(){
  try{
    const data = {
      fullName: form.fullName.value,
      email: form.email.value,
      gender: form.gender.value,
      phone: form.phone.value,
      city: form.city.value,
      prevDegree: form.prevDegree.value,
      studyType: form.studyType.value,
      facultyMajor: form.facultyMajor.value,
      certificateFile: {
        filename: form.certificateFile.files[0].name,
        mimeType: form.certificateFile.files[0].type,
        bytes: await fileToBase64(form.certificateFile.files[0])
      },
      idFile: {
        filename: form.idFile.files[0].name,
        mimeType: form.idFile.files[0].type,
        bytes: await fileToBase64(form.idFile.files[0])
      }
    };

    const response = await fetch('https://script.google.com/macros/s/AKfycbzNtKHU4fX9d3cw2iBpucixAyWgo4F91K4IxJGoveVT51Mh_w5TXXyP49d8gt-J-TYa/exec',{
      method:'POST',
      body: JSON.stringify(data),
      headers:{'Content-Type':'application/json'}
    });

    const res = await response.json();
    if(res.status==='success'){
      showToast('âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
      document.getElementById('formContainer').style.display='none';
      document.getElementById('paymentSection').style.display='block';
    }else{
      showToast('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ØŒ Ø­Ø§ÙˆÙ„ Ù„Ø§Ø­Ù‚Ø§Ù‹');
    }
  }catch(err){
    showToast('âŒ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„');
    console.error(err);
  }
}

sendData();
});

// Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¯ÙØ¹
document.getElementById('submitPayment').addEventListener('click',async function(){
const payerName = document.getElementById('payerName').value.trim();
const payerAccount = document.getElementById('payerAccount').value.trim();
const paymentDate = document.getElementById('paymentDate').value;
const receiptFile = document.getElementById('receiptFile').files[0];

if(!payerName || !payerAccount || !paymentDate || !receiptFile){
  showToast('âŒ ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙˆØ¥Ø±ÙØ§Ù‚ Ø§Ù„Ø¥ÙŠØµØ§Ù„');
  return;
}

// Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¯ÙØ¹ Ø¥Ù„Ù‰ Ù†ÙØ³ Web App
const data = {
  receiptFile: {
    filename: receiptFile.name,
    mimeType: receiptFile.type,
    bytes: await fileToBase64(receiptFile)
  }
};

fetch('https://script.google.com/macros/s/AKfycbzNtKHU4fX9d3cw2iBpucixAyWgo4F91K4IxJGoveVT51Mh_w5TXXyP49d8gt-J-TYa/exec',{
  method:'POST',
  body: JSON.stringify(data),
  headers:{'Content-Type':'application/json'}
}).then(res=>res.json()).then(r=>{
  showToast('âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø¨Ù†Ø¬Ø§Ø­');
  document.getElementById('paymentSection').style.display='none';
  document.getElementById('successMessage').style.display='block';
}).catch(err=>{
  showToast('âŒ ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø³Ø¯Ø§Ø¯');
  console.error(err);
});
});
</script>

</body>
</html>
